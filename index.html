<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#0a0a0f">
  <title>Honoka</title>
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link rel="apple-touch-icon" href="apple-touch-icon.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="app">
    <header class="header">
      <h1>Honoka</h1>
      <button class="header-btn" id="settingsBtn">⚙️</button>
    </header>

<div class="content">
  <!-- ホームタブ（カバン） -->
  <div class="tab active" id="tab-home">
    <div class="bag-header">
      <div class="bag-emoji">🎒</div>
      <div class="bag-title">カバン</div>
      <div class="bag-subtitle">本を選んで読書を始めよう</div>
    </div>

    <div class="book-carousel-container">
      <div class="book-carousel" id="bookCarousel">
        <!-- 本のカルーセルがここに表示される -->
      </div>
    </div>

    <div class="selected-book-info" id="selectedBookInfo">
      <!-- 選択中の本の情報 -->
    </div>

    <div class="home-actions-fixed">
      <button class="main-btn" id="startBtn" disabled>
        <span class="main-btn-icon">📖</span>
        <span>本を選んでください</span>
      </button>
      <div class="home-actions-row">
        <button class="btn btn-success" id="completeSelectedBtn" disabled>読み終わった！</button>
        <button class="btn btn-secondary" id="dropSelectedBtn" disabled>中断</button>
      </div>
      <button class="btn btn-secondary add-book-btn" id="addReadingBookBtn">
        <span>＋ 本を追加</span>
      </button>
    </div>

    <div class="quote-bottom">
      <p id="quoteText">読書は心の旅路。一ページが新しい世界への扉となる。</p>
      <p id="quoteAuthor">— 今日の一言</p>
    </div>
  </div>

  <!-- 書斎タブ -->
  <div class="tab" id="tab-study">
    <div class="study-header">
      <div class="study-emoji">📚</div>
      <div class="study-title">書斎</div>
      <div class="study-subtitle">あなたの本棚</div>
    </div>

    <div class="status-tabs" id="studyStatusTabs">
      <button class="status-tab active" data-status="completed">
        <span class="status-icon">✅</span>
        <span class="status-label">読了</span>
        <span class="status-count" id="completedCount">0</span>
      </button>
      <button class="status-tab" data-status="unread">
        <span class="status-icon">📚</span>
        <span class="status-label">積読</span>
        <span class="status-count" id="unreadCount">0</span>
      </button>
      <button class="status-tab" data-status="dropped">
        <span class="status-icon">⏸️</span>
        <span class="status-label">中断</span>
        <span class="status-count" id="droppedCount">0</span>
      </button>
    </div>

    <div class="shelf-container">
      <div class="shelf-board">
        <div class="shelf-visual" id="studyShelf"></div>
      </div>
    </div>

    <div id="studyBookList"></div>

    <button class="btn btn-secondary add-book-btn" id="addStudyBookBtn">
      <span>＋ 本を追加</span>
    </button>
  </div>

  <!-- 本屋タブ -->
  <div class="tab" id="tab-store">
    <div class="store-header">
      <div class="store-emoji">🏪</div>
      <div class="store-title">本屋</div>
      <div class="store-subtitle">気になっている本</div>
    </div>

    <div class="store-stats">
      <span class="store-count" id="wishlistCount">0</span>
      <span class="store-label">冊気になる</span>
    </div>

    <div id="storeBookList"></div>

    <button class="btn btn-secondary add-book-btn" id="addStoreBookBtn">
      <span>＋ 本を追加</span>
    </button>
  </div>

  <!-- 記録タブ -->
  <div class="tab" id="tab-stats">
    <div class="stats-grid">
      <div class="stats-card">
        <div class="stats-card-value" id="totalHours">0</div>
        <div class="stats-card-label">読んできた時間</div>
      </div>
      <div class="stats-card">
        <div class="stats-card-value" id="totalSessions">0</div>
        <div class="stats-card-label">本を開いた回数</div>
      </div>
      <div class="stats-card">
        <div class="stats-card-value" id="daysSince">1</div>
        <div class="stats-card-label">一緒に読書した日数</div>
      </div>
    </div>

    <h3 class="section-title">今週の読書</h3>
    <div class="week-chart" id="weekChart"></div>

    <h3 class="section-title">📖 あなたらしい読書</h3>
    <div class="style-card style-card-focus">
      <span class="style-icon">🎯</span>
      <div class="style-content">
        <div class="style-value" id="avgFocus">--</div>
        <div class="style-label">いつもの集中タイム</div>
        <div class="style-hint">1回の読書で集中している時間</div>
      </div>
    </div>
    <div class="style-card style-card-time">
      <span class="style-icon" id="timeIcon">🌙</span>
      <div class="style-content">
        <div class="style-value" id="timeType">--</div>
        <div class="style-label">読書のゴールデンタイム</div>
        <div class="style-hint">あなたが本を開きやすい時間帯</div>
      </div>
    </div>

    <h3 class="section-title">🔮 この先の読書ライフ</h3>
    <div class="prediction-card prediction-card-yearly">
      <div class="prediction-item">
        <span class="prediction-icon">📈</span>
        <div class="prediction-content">
          <div class="prediction-value" id="yearlyPrediction">--冊</div>
          <div class="prediction-label">今年の読了予想</div>
          <div class="prediction-hint">このペースで読み続けると…</div>
        </div>
      </div>
    </div>

    <div class="tip">
      <span>💡</span>
      <span id="tipText">読書を始めて記録を作ろう</span>
    </div>
  </div>
</div>

<nav class="nav">
  <button class="active" data-tab="home"><span>🎒</span><span>カバン</span></button>
  <button data-tab="study"><span>📚</span><span>書斎</span></button>
  <button data-tab="store"><span>🏪</span><span>本屋</span></button>
  <button data-tab="stats"><span>📊</span><span>記録</span></button>
</nav>

  </div>

  <!-- 読書画面 -->
  <div class="reading-screen" id="readingScreen">
    <div class="reading-anim" id="readingAnim">
      <div class="reading-glow"></div>
      <div class="reading-icon" id="readingIcon">📖</div>
    </div>
    <p class="reading-label" id="readingLabel">読書に集中しています</p>
    <button class="reading-stop" id="stopBtn">読書をおわる</button>
  </div>

  <!-- 本追加モーダル -->
  <div class="modal-overlay" id="addBookModal">
    <div class="modal">
      <div class="modal-header">
        <h2 id="addBookModalTitle">本を追加</h2>
        <button class="modal-close" data-close="addBookModal">×</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">タイトル</label>
          <input type="text" class="form-input" id="bookInput" placeholder="例：人を動かす">
        </div>
        <div class="form-group">
          <button class="link-toggle" id="linkToggle">
            <span id="linkIcon">+</span>
            <span>リンクを追加</span>
          </button>
          <div class="link-fields" id="linkFields">
            <input type="url" class="form-input" id="linkInput" placeholder="amazon.co.jp/dp/...のフルURL(短縮URLは非対応)">
          </div>
        </div>
        <input type="hidden" id="addBookStatus" value="reading">
        <label class="continue-checkbox">
          <input type="checkbox" id="continueAddCheckbox">
          <span>続けて追加</span>
        </label>
        <button class="btn btn-primary" id="addBookBtn">追加</button>
      </div>
    </div>
  </div>

  <!-- 編集モーダル -->
  <div class="modal-overlay" id="editBookModal">
    <div class="modal">
      <div class="modal-header">
        <h2>本を編集</h2>
        <button class="modal-close" data-close="editBookModal">×</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">タイトル</label>
          <input type="text" class="form-input" id="editBookTitle" placeholder="例：人を動かす">
        </div>
        <div class="form-group">
          <label class="form-label">リンク（任意）</label>
          <input type="url" class="form-input" id="editBookLink" placeholder="amazon.co.jp/dp/...のフルURL(短縮URLは非対応)">
        </div>
        <div class="form-group">
          <label class="form-label">ステータス</label>
          <select class="form-input" id="editBookStatus">
            <option value="reading">📖 読書中</option>
            <option value="completed">✅ 読了</option>
            <option value="unread">📚 積読</option>
            <option value="dropped">⏸️ 中断</option>
            <option value="wishlist">💭 気になる</option>
          </select>
        </div>
        <div class="form-row">
          <div class="form-group form-group-half">
            <label class="form-label">読み始めた日</label>
            <input type="date" class="form-input" id="editBookStartedAt">
          </div>
          <div class="form-group form-group-half">
            <label class="form-label">読み終わった日</label>
            <input type="date" class="form-input" id="editBookCompletedAt">
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">メモ（任意）</label>
          <textarea class="form-input form-textarea" id="editBookNote" placeholder="感想やメモを残せます" rows="3"></textarea>
        </div>
        <button class="btn btn-primary" id="saveEditBtn">保存</button>
        <button class="btn btn-secondary" data-close="editBookModal">キャンセル</button>
      </div>
    </div>
  </div>

  <!-- 設定モーダル -->
  <div class="modal-overlay" id="settingsModal">
    <div class="modal">
      <div class="modal-header">
        <h2>設定</h2>
        <button class="modal-close" data-close="settingsModal">×</button>
      </div>
      <div class="modal-body">
        <div class="settings-section">
          <h3 class="settings-section-title">💾 データ管理</h3>
          <div class="storage-info">
            <div class="storage-label">ストレージ使用量</div>
            <div class="storage-bar">
              <div class="storage-bar-fill" id="storageBarFill"></div>
            </div>
            <div class="storage-text"><span id="storageUsed">0</span> KB / 5 MB</div>
          </div>
          <div class="settings-btns">
            <button class="btn btn-secondary" id="exportBtn">📤 バックアップ</button>
            <button class="btn btn-secondary" id="importBtn">📥 復元</button>
            <input type="file" id="importFile" accept=".json" style="display:none">
          </div>
        </div>
        <div class="settings-section">
          <h3 class="settings-section-title">🎮 デモ</h3>
          <button class="btn btn-secondary" id="sampleDataBtn">📚 サンプルデータを読み込む</button>
          <p class="settings-hint">既存データは上書きされます</p>
        </div>
        <div class="settings-section">
          <h3 class="settings-section-title">⚠️ 危険な操作</h3>
          <button class="btn btn-danger" id="resetBtn">すべてのデータをリセット</button>
          <p class="settings-hint">読書記録・登録した本がすべて削除されます</p>
        </div>
      </div>
    </div>
  </div>

  <!-- リセット確認 -->
  <div class="confirm-overlay" id="resetConfirm">
    <div class="confirm-box">
      <div class="confirm-icon">⚠️</div>
      <div class="confirm-title">データをリセットしますか？</div>
      <div class="confirm-text">すべての記録が削除されます。この操作は取り消せません。</div>
      <div class="confirm-btns">
        <button class="confirm-cancel" data-close="resetConfirm">いいえ</button>
        <button class="confirm-ok" id="confirmResetBtn">はい</button>
      </div>
    </div>
  </div>

  <!-- サンプルデータ確認 -->
  <div class="confirm-overlay" id="sampleDataConfirm">
    <div class="confirm-box">
      <div class="confirm-icon">📚</div>
      <div class="confirm-title">サンプルデータを読み込みますか？</div>
      <div class="confirm-text">既存データは上書きされます</div>
      <div class="confirm-btns">
        <button class="confirm-cancel" data-close="sampleDataConfirm">キャンセル</button>
        <button class="confirm-ok" id="confirmSampleBtn">読み込む</button>
      </div>
    </div>
  </div>

  <!-- 本削除確認 -->
  <div class="confirm-overlay" id="deleteConfirm">
    <div class="confirm-box">
      <div class="confirm-icon">📕</div>
      <div class="confirm-title" id="deleteBookTitle">「」</div>
      <div class="confirm-text">削除しますか？</div>
      <div class="confirm-btns">
        <button class="confirm-cancel" data-close="deleteConfirm">いいえ</button>
        <button class="confirm-ok" id="confirmDeleteBtn">はい</button>
      </div>
    </div>
  </div>

  <!-- リンク確認 -->
  <div class="confirm-overlay" id="linkConfirm">
    <div class="confirm-box">
      <div class="confirm-icon">🔗</div>
      <div class="confirm-title">外部リンクを開く</div>
      <div class="confirm-text" id="linkConfirmUrl"></div>
      <div class="confirm-btns">
        <button class="confirm-cancel" data-close="linkConfirm">キャンセル</button>
        <button class="confirm-ok link" id="confirmLinkBtn">開く</button>
      </div>
    </div>
  </div>

  <script type="module" src="js/app.js"></script>
</body>
</html>
