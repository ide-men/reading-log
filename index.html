<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#0a0a0f">
  <title>Honoka</title>
  <link rel="icon" type="image/svg+xml" href="images/favicon.svg">
  <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="app">
    <header class="header">
      <h1>Honoka</h1>
      <button class="header-btn" id="settingsBtn" aria-label="設定を開く">⚙️</button>
    </header>

    <main class="content" role="main">
      <!-- ホームタブ（カバン） -->
      <section class="tab active" id="tab-home" role="tabpanel" aria-labelledby="nav-home">
    <div class="bag-header">
      <div class="bag-emoji">🎒</div>
      <div class="bag-title">カバン</div>
      <div class="bag-subtitle">本を選んで読書を始めよう</div>
    </div>

    <div class="book-carousel-container">
      <div class="book-carousel-wrapper" id="bookCarouselWrapper">
        <div class="book-carousel" id="bookCarousel">
          <!-- 本のカルーセルがここに表示される -->
        </div>
      </div>
      <div class="carousel-dots" id="carouselDots">
        <!-- ドットインジケーター -->
      </div>
    </div>

    <div class="selected-book-info" id="selectedBookInfo">
      <!-- 選択中の本の情報 -->
    </div>

    <div class="home-actions-fixed">
      <button class="main-btn" id="startBtn" disabled>
        <span class="main-btn-icon">📖</span>
        <span>本を選んでください</span>
      </button>
      <div class="home-actions-row">
        <button class="btn btn-success" id="completeSelectedBtn" disabled>読み終わった！</button>
        <button class="btn btn-secondary" id="dropSelectedBtn" disabled>中断</button>
      </div>
    </div>

    <div class="quote-bottom">
      <p id="quoteText">読書は心の旅路。一ページが新しい世界への扉となる。</p>
      <p id="quoteAuthor">— 今日の一言</p>
    </div>
      </section>

      <!-- 書斎タブ -->
      <section class="tab" id="tab-study" role="tabpanel" aria-labelledby="nav-study">
    <div class="study-header">
      <div class="study-emoji">📚</div>
      <div class="study-title">書斎</div>
      <div class="study-subtitle">あなたの本棚</div>
    </div>

    <div class="status-tabs" id="studyStatusTabs">
      <button class="status-tab" data-status="completed">
        <span class="status-icon">✅</span>
        <span class="status-label">読了</span>
        <span class="status-count" id="completedCount">0</span>
      </button>
      <button class="status-tab active" data-status="unread">
        <span class="status-icon">📚</span>
        <span class="status-label">積読</span>
        <span class="status-count" id="unreadCount">0</span>
      </button>
      <button class="status-tab" data-status="dropped">
        <span class="status-icon">⏸️</span>
        <span class="status-label">中断</span>
        <span class="status-count" id="droppedCount">0</span>
      </button>
    </div>

    <div class="shelf-container">
      <div class="shelf-board">
        <div class="shelf-visual" id="studyShelf"></div>
      </div>
    </div>

    <div id="studyBookList"></div>
      </section>

      <!-- 本屋タブ -->
      <section class="tab" id="tab-store" role="tabpanel" aria-labelledby="nav-store">
    <div class="store-header">
      <div class="store-emoji">🏪</div>
      <div class="store-title">本屋</div>
      <div class="store-subtitle">気になる本</div>
    </div>

    <div class="store-stats">
      <span class="store-count" id="wishlistCount">0</span>
      <span class="store-label">冊の本を見つけた</span>
    </div>

    <div class="store-shelf-container">
      <div class="store-shelf-board">
        <div class="store-shelf-visual" id="storeShelf"></div>
      </div>
    </div>

    <div id="storeBookList"></div>
      </section>

      <!-- 本を手に入れた時のセレブレーション -->
  <div class="acquire-celebration" id="acquireCelebration">
    <div class="acquire-particles" id="acquireParticles"></div>
    <div class="acquire-content">
      <div class="acquire-book-visual" id="acquireBookVisual"></div>
      <div class="acquire-message">
        <div class="acquire-title">🎉 手に入れた！</div>
        <div class="acquire-book-name" id="acquireBookName"></div>
        <div class="acquire-hint">書斎の積読に追加されました</div>
      </div>
    </div>
      </div>

      <!-- 記録タブ -->
      <section class="tab" id="tab-stats" role="tabpanel" aria-labelledby="nav-stats">
    <div class="stats-grid">
      <div class="stats-card">
        <div class="stats-card-value" id="totalHours">0</div>
        <div class="stats-card-label">読んできた時間</div>
      </div>
      <div class="stats-card">
        <div class="stats-card-value" id="totalSessions">0</div>
        <div class="stats-card-label">本を開いた回数</div>
      </div>
      <div class="stats-card">
        <div class="stats-card-value" id="daysSince">1</div>
        <div class="stats-card-label">一緒に読書した日数</div>
      </div>
    </div>

    <h3 class="section-title">今週の読書</h3>
    <div class="week-chart" id="weekChart"></div>

    <h3 class="section-title">📖 あなたらしい読書</h3>
    <div class="style-card style-card-focus">
      <span class="style-icon">🎯</span>
      <div class="style-content">
        <div class="style-value" id="avgFocus">--</div>
        <div class="style-label">いつもの集中タイム</div>
        <div class="style-hint">1回の読書で集中している時間</div>
      </div>
    </div>
    <div class="style-card style-card-time">
      <span class="style-icon" id="timeIcon">🌙</span>
      <div class="style-content">
        <div class="style-value" id="timeType">--</div>
        <div class="style-label">読書のゴールデンタイム</div>
        <div class="style-hint">あなたが本を開きやすい時間帯</div>
      </div>
    </div>

    <h3 class="section-title">🔮 この先の読書ライフ</h3>
    <div class="prediction-card prediction-card-yearly">
      <div class="prediction-item">
        <span class="prediction-icon">📈</span>
        <div class="prediction-content">
          <div class="prediction-value" id="yearlyPrediction">--冊</div>
          <div class="prediction-label">今年の読了予想</div>
          <div class="prediction-hint">このペースで読み続けると…</div>
        </div>
      </div>
    </div>

    <div class="tip">
      <span>💡</span>
      <span id="tipText">読書を始めて記録を作ろう</span>
    </div>
      </section>
    </main>

    <!-- 本追加FAB -->
    <button class="fab" id="addBookFab" aria-label="本を追加">
      <span class="fab-icon" aria-hidden="true">＋</span>
    </button>

    <nav class="nav" role="tablist" aria-label="メインナビゲーション">
      <button class="active" id="nav-home" data-tab="home" role="tab" aria-selected="true" aria-controls="tab-home"><span aria-hidden="true">🎒</span><span>カバン</span></button>
      <button id="nav-study" data-tab="study" role="tab" aria-selected="false" aria-controls="tab-study"><span aria-hidden="true">📚</span><span>書斎</span></button>
      <button id="nav-store" data-tab="store" role="tab" aria-selected="false" aria-controls="tab-store"><span aria-hidden="true">🏪</span><span>本屋</span></button>
      <button id="nav-stats" data-tab="stats" role="tab" aria-selected="false" aria-controls="tab-stats"><span aria-hidden="true">📊</span><span>記録</span></button>
    </nav>

  </div>

  <!-- 読書画面 -->
  <div class="reading-screen" id="readingScreen">
    <div class="reading-anim" id="readingAnim">
      <div class="reading-glow"></div>
      <div class="reading-icon" id="readingIcon">📖</div>
    </div>
    <p class="reading-label" id="readingLabel">読書に集中しています</p>
    <button class="reading-stop" id="stopBtn">読書をおわる</button>
  </div>

  <!-- 本追加モーダル -->
  <div class="modal-overlay" id="addBookModal" role="dialog" aria-modal="true" aria-labelledby="addBookModalTitle">
    <div class="modal">
      <div class="modal-header">
        <h2 id="addBookModalTitle">本を追加</h2>
        <button class="modal-close" data-close="addBookModal" aria-label="閉じる">×</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">タイトル</label>
          <input type="text" class="form-input" id="bookInput" placeholder="例：人を動かす">
        </div>
        <div class="form-group">
          <label class="form-label">一言（任意）</label>
          <input type="text" class="form-input" id="bookCommentInput" placeholder="例：友人におすすめされた本">
        </div>
        <div class="form-group">
          <button class="link-toggle" id="linkToggle">
            <span id="linkIcon">+</span>
            <span>リンクを追加</span>
          </button>
          <div class="link-fields" id="linkFields">
            <input type="url" class="form-input" id="linkInput" placeholder="amazon.co.jp/dp/...のフルURL(短縮URLは非対応)">
          </div>
        </div>
        <input type="hidden" id="addBookStatus" value="reading">
        <div class="form-group status-selector" id="studyStatusSelector" style="display: none;">
          <label class="form-label">ステータス</label>
          <div class="status-options">
            <label class="status-option">
              <input type="radio" name="studyStatus" value="unread" checked>
              <span class="status-option-label">📚 積読</span>
            </label>
            <label class="status-option">
              <input type="radio" name="studyStatus" value="completed">
              <span class="status-option-label">✅ 読了（過去に読んだ本）</span>
            </label>
            <label class="status-option">
              <input type="radio" name="studyStatus" value="dropped">
              <span class="status-option-label">⏸️ 中断（途中でやめた本）</span>
            </label>
          </div>
        </div>
        <label class="continue-checkbox">
          <input type="checkbox" id="continueAddCheckbox">
          <span>続けて追加</span>
        </label>
        <button class="btn btn-primary" id="addBookBtn">追加</button>
      </div>
    </div>
  </div>

  <!-- 編集モーダル -->
  <div class="modal-overlay" id="editBookModal" role="dialog" aria-modal="true" aria-labelledby="editBookModalTitle">
    <div class="modal">
      <div class="modal-header">
        <h2 id="editBookModalTitle">本を編集</h2>
        <button class="modal-close" data-close="editBookModal" aria-label="閉じる">×</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">タイトル</label>
          <input type="text" class="form-input" id="editBookTitle" placeholder="例：人を動かす">
        </div>
        <div class="form-group">
          <label class="form-label">リンク（任意）</label>
          <input type="url" class="form-input" id="editBookLink" placeholder="amazon.co.jp/dp/...のフルURL(短縮URLは非対応)">
        </div>
        <div class="form-group">
          <label class="form-label">ステータス</label>
          <select class="form-input" id="editBookStatus">
            <option value="reading">📖 読書中</option>
            <option value="completed">✅ 読了</option>
            <option value="unread">📚 積読</option>
            <option value="dropped">⏸️ 中断</option>
            <option value="wishlist">💭 気になる</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">メモ（任意）</label>
          <textarea class="form-input form-textarea" id="editBookNote" placeholder="感想やメモを残せます" rows="3"></textarea>
        </div>
        <button class="btn btn-primary" id="saveEditBtn">保存</button>
        <button class="btn btn-secondary" data-close="editBookModal">キャンセル</button>
      </div>
    </div>
  </div>

  <!-- 設定モーダル -->
  <div class="modal-overlay" id="settingsModal" role="dialog" aria-modal="true" aria-labelledby="settingsModalTitle">
    <div class="modal">
      <div class="modal-header">
        <h2 id="settingsModalTitle">設定</h2>
        <button class="modal-close" data-close="settingsModal" aria-label="閉じる">×</button>
      </div>
      <div class="modal-body">
        <div class="settings-section">
          <h3 class="settings-section-title">💾 データ管理</h3>
          <div class="storage-info">
            <div class="storage-label">ストレージ使用量</div>
            <div class="storage-bar">
              <div class="storage-bar-fill" id="storageBarFill"></div>
            </div>
            <div class="storage-text"><span id="storageUsed">0</span> KB / 5 MB</div>
          </div>
          <div class="settings-btns">
            <button class="btn btn-secondary" id="exportBtn">📤 バックアップ</button>
            <button class="btn btn-secondary" id="importBtn">📥 復元</button>
            <input type="file" id="importFile" accept=".json" style="display:none">
          </div>
        </div>
        <div class="settings-section">
          <h3 class="settings-section-title">🎮 デモ</h3>
          <button class="btn btn-secondary" id="sampleDataBtn">📚 サンプルデータを読み込む</button>
          <p class="settings-hint">既存データは上書きされます</p>
        </div>
        <div class="settings-section">
          <h3 class="settings-section-title">⚠️ 危険な操作</h3>
          <button class="btn btn-danger" id="resetBtn">すべてのデータをリセット</button>
          <p class="settings-hint">読書記録・登録した本がすべて削除されます</p>
        </div>
      </div>
    </div>
  </div>

  <!-- リセット確認 -->
  <div class="confirm-overlay" id="resetConfirm" role="alertdialog" aria-modal="true" aria-labelledby="resetConfirmTitle">
    <div class="confirm-box">
      <div class="confirm-icon" aria-hidden="true">⚠️</div>
      <div class="confirm-title" id="resetConfirmTitle">データをリセットしますか？</div>
      <div class="confirm-text">すべての記録が削除されます。この操作は取り消せません。</div>
      <div class="confirm-btns">
        <button class="confirm-cancel" data-close="resetConfirm">いいえ</button>
        <button class="confirm-ok" id="confirmResetBtn">はい</button>
      </div>
    </div>
  </div>

  <!-- サンプルデータ確認 -->
  <div class="confirm-overlay" id="sampleDataConfirm" role="alertdialog" aria-modal="true" aria-labelledby="sampleDataConfirmTitle">
    <div class="confirm-box">
      <div class="confirm-icon" aria-hidden="true">📚</div>
      <div class="confirm-title" id="sampleDataConfirmTitle">サンプルデータを読み込みますか？</div>
      <div class="confirm-text">既存データは上書きされます</div>
      <div class="confirm-btns">
        <button class="confirm-cancel" data-close="sampleDataConfirm">キャンセル</button>
        <button class="confirm-ok" id="confirmSampleBtn">読み込む</button>
      </div>
    </div>
  </div>

  <!-- 本削除確認 -->
  <div class="confirm-overlay" id="deleteConfirm" role="alertdialog" aria-modal="true" aria-labelledby="deleteBookTitle">
    <div class="confirm-box">
      <div class="confirm-icon" aria-hidden="true">📕</div>
      <div class="confirm-title" id="deleteBookTitle">「」</div>
      <div class="confirm-text">削除しますか？</div>
      <div class="confirm-btns">
        <button class="confirm-cancel" data-close="deleteConfirm">いいえ</button>
        <button class="confirm-ok" id="confirmDeleteBtn">はい</button>
      </div>
    </div>
  </div>

  <!-- 書籍詳細ダイアログ -->
  <div class="modal-overlay" id="bookDetailModal" role="dialog" aria-modal="true" aria-labelledby="bookDetailModalTitle">
    <div class="modal book-detail-modal">
      <div class="modal-header">
        <h2 id="bookDetailModalTitle">書籍詳細</h2>
        <button class="modal-close" data-close="bookDetailModal" aria-label="閉じる">×</button>
      </div>
      <div class="modal-body">
        <div class="book-detail-content">
          <div class="book-detail-cover" id="bookDetailCover"></div>
          <div class="book-detail-info">
            <div class="book-detail-title" id="bookDetailTitle"></div>
            <div class="book-detail-meta" id="bookDetailMeta"></div>
            <div class="book-detail-note" id="bookDetailNote"></div>
          </div>
        </div>
        <div class="book-detail-actions">
          <button class="btn btn-secondary book-detail-btn" id="bookDetailLinkBtn" style="display:none">
            <span>↗</span>
            <span>リンクを開く</span>
          </button>
          <button class="btn btn-secondary book-detail-btn" id="bookDetailEditBtn">
            <span>✏️</span>
            <span>編集</span>
          </button>
          <button class="btn btn-danger book-detail-btn" id="bookDetailDeleteBtn">
            <span>×</span>
            <span>削除</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- リンク確認 -->
  <div class="confirm-overlay" id="linkConfirm" role="alertdialog" aria-modal="true" aria-labelledby="linkConfirmTitle">
    <div class="confirm-box">
      <div class="confirm-icon" aria-hidden="true">🔗</div>
      <div class="confirm-title" id="linkConfirmTitle">外部リンクを開く</div>
      <div class="confirm-text" id="linkConfirmUrl"></div>
      <div class="confirm-btns">
        <button class="confirm-cancel" data-close="linkConfirm">キャンセル</button>
        <button class="confirm-ok link" id="confirmLinkBtn">開く</button>
      </div>
    </div>
  </div>

  <script type="module" src="js/app.js"></script>
</body>
</html>
